<?xml version="1.0" encoding="utf-8"?>
<container xmlns="http://symfony.com/schema/dic/services" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">
    <services>
        <service id="pdo" class="PDO" public="false">
            <argument>%db.system%:host=%db.host%;dbname=%db.database%</argument>
            <argument>%db.user%</argument>
            <argument>%db.password%</argument>
            <argument type="collection">
                <argument key="1002">SET NAMES utf8</argument>
            </argument>
        </service>

        <service id="predis" class="Predis\Client" public="false">
            <argument type="collection">
                <argument key="read_write_timeout">0</argument>
                <argument key="host">%redis.host%</argument>
            </argument>
        </service>

        <service id="monolog.logger" class="Monolog\Logger">
            <argument>%application.name%</argument>
			<call method="pushHandler">
				<argument type="service" id="monolog.ErrorLog"/>
			</call>
        </service>
        <service id="monolog.ErrorLog" class="Monolog\Handler\StreamHandler" public="false">
            <argument>%logger.error.log%</argument>
            <argument type="constant">Monolog\Logger::DEBUG</argument>
        </service>

		<service id="Application" class="Silex\Application">
			<argument type="collection">
				<argument key="debug">%debug%</argument>
			</argument>

			<call method="register">
				<argument type="service">
					<service class="Silex\Provider\TwigServiceProvider"/>
				</argument>
				<argument type="collection">
					<argument key="twig.path">../templates</argument>
				</argument>
			</call>
			<call method="register">
				<argument type="service">
					<service class="Silex\Provider\SessionServiceProvider"/>
				</argument>
			</call>
		</service>

		<service id="Console" class="Symfony\Component\Console\Application">
			<call method="setAutoExit">
				<argument>false</argument>
			</call>
		</service>
    </services>
</container>
