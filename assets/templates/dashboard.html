<nav class="navbar navbar-default" role="navigation">
    <div class="container-fluid">
        <div class="navbar-header">
            <button
                    type="button"
                    class="navbar-toggle"
                    data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1"
            >
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li
                        ng-repeat="(dashboardId, tmp_dashboard) in dashboards"
                        class="btn-group cursor"
                        ng-class="{active:tmp_dashboard==dashboard}"
                >
                    <a ng-click="selectDashboard(tmp_dashboard)">
                        {{ tmp_dashboard.name }}
                    </a>
                </li>
                <li class="btn-group">
                    <a ng-click="openModal(dashboards, dashboard)" tooltip="{{'New Widget'|translate}}">
                        <span class="glyphicon glyphicon-plus cursor"></span>
                    </a>
                </li>
                <li class="btn-group">
                    <a ng-click="editMode = !editMode" tooltip="{{'Edit'|translate}}">
                        <span class="glyphicon glyphicon-edit cursor"></span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div ng-if="dashboard" class="span-9 dashboard">
    <h2>{{ dashboard.name }}</h2>
    <div ng-if="editMode">
        <div class="input-group">
            <span class="input-group-addon" translate>Name</span>
            <input
                   type="text"
                   ng-model="dashboard.name"
                   class="form-control"
                    />
            <span class="input-group-addon">
                <a ng-click="saveDashboard(dashboard)" class="cursor" translate>Save</a>
            </span>
        </div>
        <span
                ng-click="deleteDashboard(dashboard.dashboardId)"
                class="delete glyphicon glyphicon-remove cursor"
                tooltip="Delete">
        </span>
    </div>
    <div class="container-fluid">
        <div class="row" as-sortable="dragControlListeners" ng-model="dashboard.widgets">
            <div
                    class="col-xs-{{metadata(widget.type, 'width')}} as-sortable-item"
                    ng-repeat="widget in dashboard.widgets"
                    as-sortable-item
            >
                <div class="panel panel-default widget" ng-controller="WidgetController">
                    <div
                            class="panel-heading as-sortable-item-handle"
                            as-sortable-item-handle
                            ng-click="toggleWidget(widget, dashboard)"
                    >
                        {{ title }}
                        <span
                                ng-if="editMode"
                                ng-click="deleteWidget(dashboard.dashboardId, widget.id)"
                                class="delete glyphicon glyphicon-remove cursor"
                                tooltip="Delete"
                                >
                        </span>
                    </div>
                    <div class="panel-body widget_{{widget.type}}" id="widget_{{widget.id}}" ng-show="widget.open">
                        <content-item widget="widget"></content-item>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
